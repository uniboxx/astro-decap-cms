---
import { render } from 'astro:content';
import Time from '../../components/Time.astro';
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});




// console.log(posts);
console.log(posts[0].body);
---

<Layout>
  <main>
    <h1>Blog</h1>

    <div class="posts__list">
      <div class="header">
        <p>Title</p>
        <p>Published</p>
      </div>

      {
        posts.map((post) => {
          return (
            <p class="post__item">
              <a href={`/blog/${post.id}`}>{post.data.title}</a>
              <span>
                Published: <Time time={post.data.date} />
              </span>
            </p>
            <p class="excerpt">{post.body?.slice(0,100)+' ...'} <a href={`/blog/${post.id}`}>Read more</a></span></p>
          )
        })
      }
    </div>
  </main>
</Layout>

<style>
  main {
    padding: 2rem;
  }
  .posts__list {
    max-width: 500px;
  }
  .header,
  .post__item {
    display: flex;
    justify-content: space-between;
  }
  .header {
    font-weight: bold;
  }
  .excerpt {
    font-size: .8rem;
    a{
      display: block;
    }
  }
</style>
